#pragma once
#include "ArrIter.h"

namespace Atom
{
    /// --------------------------------------------------------------------------------------------
    /// 
    /// --------------------------------------------------------------------------------------------
    template <typename T, usize Size>
    class StaticArray
    {
    public:
        using TElem = T;
        using TIter = ArrIter<T>;
        using TIterEnd = TIter;
        using TMutIter = MutArrIter<T>;
        using TMutIterEnd = TMutIter;

    public:
        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr bool operator == (const StaticArray& other) const noexcept
        {
            for (usize i = 0; i < Size; i++)
            {
                if (_arr[i] != other._arr[i])
                    return false;
            }

            return true;
        }

        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr bool operator != (const StaticArray& other) const noexcept
        {
            return !(*this == other);
        }

    public:
        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr T& operator [](usize index) noexcept
        {
            return _arr[index];
        }

        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr const T& operator [](usize index) const noexcept
        {
            return _arr[index];
        }

    public:
        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr T* Data() noexcept
        {
            return _arr;
        }

        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr const T* Data() const noexcept
        {
            return _arr;
        }

        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr usize Count() const noexcept
        {
            return Size;
        }

    public:
        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr TIter Iter() const noexcept
        {
            return TMutIter{ _arr };
        }

        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr TIter IterEnd() const noexcept
        {
            return TMutIter{ _arr + Size};
        }

        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr TMutIter MutIter() noexcept
        {
            return TMutIter{ _arr };
        }

        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr TMutIter MutIterEnd() noexcept
        {
            return TMutIter{ _arr + Size };
        }

        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr TIter begin() const noexcept
        {
            return Iter();
        }

        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr TIter end() const noexcept
        {
            return IterEnd();
        }

        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr TMutIter begin() noexcept
        {
            return MutIter();
        }

        /// ----------------------------------------------------------------------------------------
        /// 
        /// ----------------------------------------------------------------------------------------
        constexpr TMutIter end() noexcept
        {
            return MutIterEnd();
        }

    public:
        /// ----------------------------------------------------------------------------------------
        /// This is public only to allow aggregate initialization. This should not be accessed 
        /// outside the class.
        /// ----------------------------------------------------------------------------------------
        T _arr[Size];
    };
}